<html>
    <head>
        <title>AEON - POS System</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous"></link>                
        <link href="styles.scss" rel="stylesheet"/>
    </head>
    <body onkeypress="handle(event)">
        <div class="container" id="product-found-container">
            <div class="card" style="padding:20px;">
                <div class="row">
                    <div class="col-7 px 3" style="margin:auto;">
                        <div class="card-block" style="padding:20px;">
                            <h3 class="card-title" id="product-name" style="font-size:52px;">Product Product Product 01</h3>                                
                            <div class="row" style="margin-bottom:30px;">
                                <div class="col-lg-6" >
                                    <span class="card-text product-price" id="product-price" style="font-size:3em; color:#C4C4C4;">Rp 100000</span>
                                </div>
                                <div class="col-lg-6">
                                    <h3 class="card-text product-discount-price" id="product-discount-price" style="font-size:3em;color: #AD2181">Rp 95000</h3>
                                </div>
                            </div>                                
                            <div class="row">
                                <div class="col-lg-12">
                                    <h3 class="card-text product-discount-amount" id="product-discount-amount" style="font-size:2em;">Hemat Rp 5000</h3>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                    <div class="col-5">
                        <img class="card-img" id="product-image" src="no-image.png"/>
                    </div>
                </div>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>                   
        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>
            function backToHome() {
                document.body.style.backgroundImage = "url('blank_page.png')";                        
                document.getElementById("product-container").style.display = "none";
                document.getElementById("product-price").innerHTML = "";
                document.getElementById("product-discount-price").innerHTML = "";
                document.getElementById("product-name").innerHTML = "";
                document.getElementById("product-discount-amount").innerHTML = "";
            }                      
            function goToProductNotFound() {
                document.body.style.backgroundImage = "url('product_not_found.png')";                        
                document.getElementById("product-container").style.display = "none";
            }
            function goToProductFound() {
                document.body.style.backgroundImage = "url('blank_page.png')";                        
                document.getElementById("product-container").style.display = "block";
            }
            var value = '';
            async function handle(e){
                if(e.keyCode === 13){
                    e.preventDefault(); // Ensure it is only this code that runs                            
                    console.log(value);      
                    document.getElementById("product-price").innerHTML = "";
                    document.getElementById("product-discount-price").innerHTML = "";
                    document.getElementById("product-name").innerHTML = "";
                    document.getElementById("product-discount-amount").innerHTML = "";                                                      
                    fetch('/pos/price/product/7001/' + value)
                    .then((response) => response.json())
                    .then((response_json) => {    
                        console.log(response_json);
                        value = '';
                        if (response_json.err == true){
                            goToProductNotFound();
                            new Promise(function(resolve, reject) { 
                                setTimeout(() => {
                                    backToHome();
                                    resolve();
                                }, 5000)
                            });
                        }else{
                            var data = response_json.data;
                            console.log(data);
                            console.log(data.list_price);
                            if(data.is_diff){
                                document.getElementById("product-price").innerHTML = data.list_price;
                            }
                            document.getElementById("product-discount-price").innerHTML = data.current_price;                                    
                            document.getElementById("product-name").innerHTML = data.display_name;
                            document.getElementById("product-image").src = data.image_url;
                            if(data.is_diff){
                                document.getElementById("product-discount-amount").innerHTML = "Hemat : " + data.diff;
                            }
                            goToProductFound();
                            new Promise(function(resolve, reject) { 
                                setTimeout(() => {
                                    backToHome();
                                    resolve();
                                }, 5000)
                            });
                        }
                    });
                }else{
                    console.log(e.keyCode);
                    value = value + String.fromCharCode(e.keyCode);
                }
            }
        </script>
    </body>
</html>