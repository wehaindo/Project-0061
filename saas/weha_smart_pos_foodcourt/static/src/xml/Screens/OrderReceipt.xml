<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="OrderReceipt" t-inherit="point_of_sale.OrderReceipt" t-inherit-mode="extension" owl="1">
        <xpath expr="//div[hasclass('receipt-change')]" position="replace">
            <t t-if="props.order.attributes.change_amount_for_wallet">
                <div class="pos-receipt">
                    <table style="width:100%;">
                        <tbody>
                            <t t-if="props.order.attributes.change_amount_for_wallet">
                                <tr>
                                    <td class="pos-left-align">Added to Wallet</td>
                                    <td class="pos-right-align"><t t-esc="env.pos.format_currency(props.order.attributes.change_amount_for_wallet)"/></td>
                                </tr>
                            </t>
                            <t t-else="">
                            </t>
                        </tbody>
                    </table>
                    <br/>
                </div>
            </t>
            <t t-else="">
                <div class="pos-receipt">
                    <table style="width:100%;">
                        <tbody>
                            <tr>
                                <td class="pos-left-align">Change</td>
                                <td class="pos-right-align"><t t-esc="props.order.get_change()"/></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </t>
        </xpath>

        <xpath expr="//div[hasclass('before-footer')]" position="inside">
            <t t-if="env.pos.config.receipt_balance">
                <t t-if="props.order.attributes.change_amount_for_wallet || props.order.used_amount_from_wallet ">
                    <div class="pos-receipt">
                        <br/>
                        <div>-----------------------------------------------------</div>
                        <div class="pos-center-align">Wallet Details</div>
                        <div>-----------------------------------------------------</div>
                        <table style="width:100%;">
                            <tbody>
                                <tr>
                                    <td class="pos-left-align">Customer Name:</td>
                                    <td class="pos-right-align"> <t t-esc="env.pos.get_order().get_client_name()"/> </td>
                                </tr>
                                <t t-if="props.order.used_amount_from_wallet">
                                    <tr>
                                        <td class="pos-left-align">Available Balance:</td>
                                        <td class="pos-right-align"><t t-esc="env.pos.format_currency((env.pos.get_order().get_client().remaining_wallet_amount - props.order.used_amount_from_wallet) + props.order.attributes.change_amount_for_wallet)" /></td>
                                    </tr>
                                </t>
                                <t t-else="">
                                    <tr>
                                        <td class="pos-left-align">Available Balance:</td>
                                        <td class="pos-right-align"><t t-esc="env.pos.format_currency(env.pos.get_order().get_client().remaining_wallet_amount + props.order.attributes.change_amount_for_wallet)" /></td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                        <br/>
                    </div>
                </t>
                <t t-if="env.pos.get_order().get_type_for_wallet() == 'recharge'">
                     <div class="pos-receipt">
                        <br/>
                        <div>-----------------------------------------------------</div>
                        <div class="pos-center-align">Wallet Details</div>
                        <div>-----------------------------------------------------</div>
                        <table style="width:100%;">
                            <tbody>
                                <tr>
                                    <td class="pos-left-align">Customer Name:</td>
                                    <td class="pos-right-align">
                                        <t t-esc="env.pos.get_order().get_client_name()"/>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="pos-left-align">Available Balance:</td>
                                    <td class="pos-right-align">
                                        <t t-esc="env.pos.format_currency(env.pos.get_order().get_client().remaining_wallet_amount + env.pos.get_order().get_total_paid())" />
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br/>
                    </div>
                </t>
            </t>
        </xpath>
    </t>
</templates>